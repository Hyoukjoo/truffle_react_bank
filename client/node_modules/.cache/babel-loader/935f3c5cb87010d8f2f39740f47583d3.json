{"ast":null,"code":"import _regeneratorRuntime from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"c:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport getWeb3 from './utils/getWeb3';\nimport truffleContract from 'truffle-contract';\nimport Bank from './contracts/Bank.json';\nimport IndexPage from './component/IndexPage';\nimport ListPage from './component/ListPage';\nimport InputMoney from './component/InputMoney';\nimport OutputMoney from './component/OutputMoney';\nimport Submit from './component/Submit';\nimport Statement from './component/Statement';\nimport CheckPassword from './component/CheckPassword';\nimport Remit from './component/Remit';\nimport EnterMoney from './component/EnterMoney';\nimport \"./css/App.css\";\nimport { USERS } from './DB';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      web3: null,\n      accounts: null,\n      contract: null,\n      balance: 0,\n      user: ''\n    };\n    _this.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var web3, accounts, Contract, instance;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getWeb3();\n\n            case 3:\n              web3 = _context.sent;\n              _context.next = 6;\n              return web3.eth.getAccounts();\n\n            case 6:\n              accounts = _context.sent;\n              // Deploy Contract\n              Contract = truffleContract(Bank);\n              Contract.setProvider(web3.currentProvider);\n              _context.next = 11;\n              return Contract.deployed();\n\n            case 11:\n              instance = _context.sent;\n\n              // Set web3, accounts, contract in state\n              _this.setState({\n                web3: web3,\n                accounts: accounts,\n                contract: instance\n              }); //Clear localStorage\n\n\n              localStorage.clear();\n              _context.next = 20;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](0);\n              // Catch any errors for any of the above operations.\n              alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n              console.log(_context.t0);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 16]]);\n    }));\n    _this._addUser =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var i, _USERS$i, userBank, userName, password, etherAccount, balanceOf;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              i = 0;\n\n            case 1:\n              if (!(i < USERS.length)) {\n                _context2.next = 10;\n                break;\n              }\n\n              USERS[i].etherAccount = _this.state.accounts[i + 1];\n              _USERS$i = USERS[i], userBank = _USERS$i.userBank, userName = _USERS$i.userName, password = _USERS$i.password, etherAccount = _USERS$i.etherAccount, balanceOf = _USERS$i.balanceOf;\n              console.log(\"App_addUser : \", etherAccount);\n              _context2.next = 7;\n              return _this.state.contract.addUser(userBank, userName, password, etherAccount, balanceOf, {\n                from: _this.state.accounts[0]\n              });\n\n            case 7:\n              i++;\n              _context2.next = 1;\n              break;\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n    _this._getUser =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var user;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _this.state.contract.getUser();\n\n            case 2:\n              user = _context3.sent;\n\n              if (user === '') {\n                console.log(\"Input your address correctly\");\n\n                _this.props.history.push('/');\n              } else {\n                _this.setState({\n                  user: user\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n    _this._getBalance =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var balance;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _this.state.contract.getBalance();\n\n            case 2:\n              balance = _context4.sent;\n\n              _this.setState({\n                balance: balance.words[0]\n              });\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    _this._login =\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(account) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return _this.state.contract.setUser(account, {\n                  from: _this.state.accounts[0]\n                });\n\n              case 3:\n                //Get balance of user from the cantract\n                _this._getUser();\n\n                _this._getBalance(); //set balance in localStorage\n\n\n                localStorage.setItem('isLogin', \"true\");\n\n                _this.props.history.push('/listpage');\n\n                _context5.next = 12;\n                break;\n\n              case 9:\n                _context5.prev = 9;\n                _context5.t0 = _context5[\"catch\"](0);\n                console.log(_context5.t0);\n\n              case 12:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 9]]);\n      }));\n\n      return function (_x) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    _this._logout =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return _this.state.contract.initUser({\n                from: _this.state.accounts[0]\n              });\n\n            case 2:\n              //Set the balance for null in state\n              _this.setState({\n                balance: 0,\n                user: ''\n              }); //Clear localStorage\n\n\n              localStorage.clear();\n\n              _this.props.history.push('/');\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    _this._redirectLogin = function () {\n      console.log('고객 정보가 없습니다.');\n      return React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _login = this._login,\n          _logout = this._logout,\n          _redirectLogin = this._redirectLogin,\n          _addUser = this._addUser,\n          state = this.state;\n\n      if (!this.state.web3) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, \"Loading Web3, accounts, and contract...\");\n      }\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        render: function render() {\n          return React.createElement(IndexPage, {\n            info: state,\n            login: _login,\n            init: _addUser,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/listpage\",\n        render: function render() {\n          return React.createElement(ListPage, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 134\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/inputmoney\",\n        render: function render() {\n          return React.createElement(InputMoney, {\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 137\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/checkpassword/:purpose\",\n        render: function render() {\n          return React.createElement(CheckPassword, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 140\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/outputmoney\",\n        render: function render() {\n          return React.createElement(OutputMoney, {\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 143\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/submit/:purpose\",\n        render: function render() {\n          return React.createElement(Submit, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/statement/:purpose\",\n        render: function render() {\n          return React.createElement(Statement, {\n            contract: state.contract,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 149\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/remit\",\n        render: function render() {\n          return React.createElement(Remit, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 152\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/entermoney/:purpose\",\n        render: function render() {\n          return React.createElement(EnterMoney, {\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 154\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nApp.propTypes = {\n  balance: PropTypes.number\n};\nexport default withRouter(App);","map":{"version":3,"sources":["c:\\Users\\judam\\Documents\\HJ\\dev\\truffle_react\\client\\src\\App.js"],"names":["React","Component","Route","Switch","withRouter","Redirect","PropTypes","getWeb3","truffleContract","Bank","IndexPage","ListPage","InputMoney","OutputMoney","Submit","Statement","CheckPassword","Remit","EnterMoney","USERS","App","state","web3","accounts","contract","balance","user","componentDidMount","eth","getAccounts","Contract","setProvider","currentProvider","deployed","instance","setState","localStorage","clear","alert","console","log","_addUser","i","length","etherAccount","userBank","userName","password","balanceOf","addUser","from","_getUser","getUser","props","history","push","_getBalance","getBalance","words","_login","account","setUser","setItem","_logout","initUser","_redirectLogin","propTypes","number"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport getWeb3 from './utils/getWeb3'\r\nimport truffleContract from 'truffle-contract'\r\nimport Bank from './contracts/Bank.json'\r\n\r\nimport IndexPage from './component/IndexPage'\r\nimport ListPage from './component/ListPage'\r\nimport InputMoney from './component/InputMoney'\r\nimport OutputMoney from './component/OutputMoney'\r\nimport Submit from './component/Submit'\r\nimport Statement from './component/Statement'\r\nimport CheckPassword from './component/CheckPassword';\r\nimport Remit from './component/Remit';\r\nimport EnterMoney from './component/EnterMoney';\r\n\r\nimport \"./css/App.css\"\r\nimport{ USERS } from './DB'\r\n\r\nclass App extends Component {\r\n  state = { web3: null, accounts: null, contract: null, balance: 0, user: ''}\r\n\r\n  static propTypes = {\r\n    balance: PropTypes.number\r\n  }\r\n  \r\n  componentDidMount = async () => {\r\n    try {\r\n      // Get network provider and web3 instance.\r\n      const web3 = await getWeb3()\r\n      \r\n      // Use web3 to get the user's accounts.\r\n      const accounts = await web3.eth.getAccounts()\r\n      \r\n      // Deploy Contract\r\n      const Contract = truffleContract(Bank)\r\n      Contract.setProvider(web3.currentProvider)\r\n      const instance = await Contract.deployed()\r\n      \r\n      // Set web3, accounts, contract in state\r\n      this.setState({ web3, accounts, contract : instance })\r\n      \r\n      //Clear localStorage\r\n      localStorage.clear()\r\n    } catch (error) {\r\n      // Catch any errors for any of the above operations.\r\n      alert(\r\n        `Failed to load web3, accounts, or contract. Check console for details.`\r\n        )\r\n        console.log(error)\r\n    }\r\n\r\n    //Set initial user informations in the contract\r\n    // this._addUser()\r\n  }\r\n    \r\n    //Add user informations in the contract\r\n  _addUser = async () => {\r\n    for(let i=0; i<USERS.length; i++){\r\n      USERS[i].etherAccount = this.state.accounts[i+1]\r\n      const {userBank, userName, password, etherAccount, balanceOf} = USERS[i]\r\n      console.log(\"App_addUser : \", etherAccount)\r\n      await this.state.contract.addUser(userBank, userName, password, etherAccount, balanceOf, { from: this.state.accounts[0] })\r\n    }\r\n  }\r\n  \r\n  _getUser = async () => {\r\n    const user = await this.state.contract.getUser()\r\n    if(user === '') {\r\n      console.log(\"Input your address correctly\")\r\n      this.props.history.push('/')\r\n    } else {\r\n      this.setState({ user : user })\r\n    }\r\n  }\r\n  \r\n  _getBalance = async () => {\r\n    const balance = await this.state.contract.getBalance()\r\n    this.setState({ balance : balance.words[0] })\r\n  }\r\n\r\n  _login = async account => {\r\n    try{\r\n      //Set user in the contract\r\n      await this.state.contract.setUser(account, { from: this.state.accounts[0] })\r\n\r\n      //Get balance of user from the cantract\r\n      this._getUser()\r\n      this._getBalance()\r\n\r\n      //set balance in localStorage\r\n      localStorage.setItem('isLogin', \"true\")\r\n\r\n      this.props.history.push('/listpage')\r\n\r\n    } catch(error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  _logout = async () => {\r\n    //Initialize user in the contract\r\n    await this.state.contract.initUser({ from : this.state.accounts[0] })\r\n\r\n    //Set the balance for null in state\r\n    this.setState({ balance : 0, user : ''})\r\n\r\n    //Clear localStorage\r\n    localStorage.clear()\r\n\r\n    this.props.history.push('/')\r\n  }\r\n\r\n  _redirectLogin = () => {\r\n    console.log('고객 정보가 없습니다.')\r\n    return <Redirect to='/' />\r\n  }\r\n\r\n  render() {\r\n    const {_login, _logout, _redirectLogin, _addUser, state} = this\r\n\r\n    if (!this.state.web3) {\r\n      return <div>Loading Web3, accounts, and contract...</div>\r\n    }\r\n    return (\r\n      <div className=\"App\">\r\n        <Switch>\r\n          <Route exact path='/'\r\n            render={() => (<IndexPage info={state} login={_login} init={_addUser} />)}\r\n          />\r\n          <Route path=\"/listpage\" \r\n            render={() => (<ListPage info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/inputmoney' \r\n            render={() => (<InputMoney logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/checkpassword/:purpose'\r\n            render={()=> (<CheckPassword info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/outputmoney'\r\n            render={() => (<OutputMoney logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/submit/:purpose' \r\n            render={() => (<Submit info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/statement/:purpose' \r\n            render={() => (<Statement contract={state.contract} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/remit' \r\n            render={() => (<Remit info={state} logout={_logout} redirect={_redirectLogin} />)} />\r\n          <Route path='/entermoney/:purpose' \r\n            render={() => (<EnterMoney logout={_logout} redirect={_redirectLogin} />)} />\r\n        </Switch>\r\n      </div>\r\n    );\r\n  }\r\n} \r\n\r\nexport default withRouter(App)\r\n"]},"metadata":{},"sourceType":"module"}