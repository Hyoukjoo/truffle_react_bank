{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\judam\\\\Documents\\\\HJ\\\\dev\\\\truffle_react\\\\client\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom';\nimport getWeb3 from './utils/getWeb3';\nimport truffleContract from 'truffle-contract';\nimport Bank from './contracts/Bank.json';\nimport IndexPage from './component/IndexPage';\nimport ListPage from './component/ListPage';\nimport InputMoney from './component/InputMoney';\nimport Submit from './component/Submit';\nimport Statement from './component/Statement';\nimport CheckPassword from './component/CheckPassword';\nimport Remit from './component/Remit';\nimport EnterMoney from './component/EnterMoney';\nimport ViewTransactions from './component/ViewTransactions';\nimport \"./css/App.css\";\nimport { USERS } from './DB/DB';\nimport { Kane, Trout, Kershow, Johnson } from './DB/UserInfo';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      web3: null,\n      accounts: null,\n      contract: null,\n      userAddress: null\n    };\n    _this.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var web3, _accounts, Contract, instance, accounts;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getWeb3();\n\n            case 3:\n              web3 = _context.sent;\n              _context.next = 6;\n              return web3.eth.getAccounts();\n\n            case 6:\n              _accounts = _context.sent;\n              // Deploy Contract\n              Contract = truffleContract(Bank);\n              Contract.setProvider(web3.currentProvider);\n              _context.next = 11;\n              return Contract.deployed();\n\n            case 11:\n              instance = _context.sent;\n\n              // Set web3, accounts, contract in state\n              _this.setState({\n                web3: web3,\n                accounts: _accounts,\n                contract: instance\n              }); //Clear localStorage\n\n\n              localStorage.clear();\n              _context.next = 20;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](0);\n              // Catch any errors for any of the above operations.\n              alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n              console.log(_context.t0);\n\n            case 20:\n              accounts = _this.state.accounts;\n              USERS.set(accounts[1], Kane);\n              USERS.set(accounts[2], Trout);\n              USERS.set(accounts[3], Kershow);\n              USERS.set(accounts[4], Johnson); //Set initial user informations in the contract\n              // this._addUser()\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 16]]);\n    }));\n    _this._initUser =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var accounts, Kane, Trout, Kershow, Johnson, userInfo, i, _userInfo$i, userBank, userName, password, userAddress, balanceOf;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              accounts = _this.state.accounts;\n              Kane = USERS.get(accounts[1]);\n              Trout = USERS.get(accounts[2]);\n              Kershow = USERS.get(accounts[3]);\n              Johnson = USERS.get(accounts[4]);\n              userInfo = [Kane, Trout, Kershow, Johnson];\n              i = 0;\n\n            case 7:\n              if (!(i < userInfo.length)) {\n                _context2.next = 15;\n                break;\n              }\n\n              _userInfo$i = userInfo[i], userBank = _userInfo$i.userBank, userName = _userInfo$i.userName, password = _userInfo$i.password, userAddress = _userInfo$i.userAddress, balanceOf = _userInfo$i.balanceOf;\n              console.log(\"App_initUser : \", userAddress);\n              _context2.next = 12;\n              return _this.state.contract.addUser(userBank, userName, password, userAddress, balanceOf, {\n                from: _this.state.accounts[0]\n              });\n\n            case 12:\n              i++;\n              _context2.next = 7;\n              break;\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    _this._login =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(address) {\n        var _this$state, contract, accounts, userName, userAddress;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this$state = _this.state, contract = _this$state.contract, accounts = _this$state.accounts;\n                _context3.prev = 1;\n                _context3.next = 4;\n                return contract.setUser(address, {\n                  from: accounts[0]\n                });\n\n              case 4:\n                _context3.next = 6;\n                return contract.getUserName();\n\n              case 6:\n                userName = _context3.sent;\n                userAddress = address;\n\n                _this.setState({\n                  userAddress: userAddress\n                });\n\n                if (userName === '') {\n                  console.log(\"Input your address correctly\");\n\n                  _this.props.history.push('/');\n                } else {\n                  //set balance in localStorage\n                  localStorage.setItem('isLogin', \"true\");\n\n                  _this.props.history.push('/listpage');\n                }\n\n                _context3.next = 15;\n                break;\n\n              case 12:\n                _context3.prev = 12;\n                _context3.t0 = _context3[\"catch\"](1);\n                console.log(_context3.t0);\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[1, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this._logout =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _this.state.contract.initUser({\n                from: _this.state.accounts[0]\n              });\n\n            case 2:\n              //Set the balance for null in state\n              _this.setState({\n                balance: 0,\n                userName: ''\n              }); //Clear localStorage\n\n\n              localStorage.clear();\n\n              _this.props.history.push('/');\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    _this._redirectLogin = function () {\n      console.log('고객 정보가 없습니다.');\n      return React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _login = this._login,\n          _logout = this._logout,\n          _redirectLogin = this._redirectLogin,\n          _initUser = this._initUser,\n          state = this.state;\n\n      if (!this.state.web3) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, \"Loading Web3, accounts, and contract...\");\n      }\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        render: function render() {\n          return React.createElement(IndexPage, {\n            info: state,\n            login: _login,\n            init: _initUser,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/listpage\",\n        render: function render() {\n          return React.createElement(ListPage, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 148\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/inputmoney\",\n        render: function render() {\n          return React.createElement(InputMoney, {\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 151\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/checkpassword/:purpose\",\n        render: function render() {\n          return React.createElement(CheckPassword, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 154\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/submit/:purpose\",\n        render: function render() {\n          return React.createElement(Submit, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 157\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/statement/:purpose\",\n        render: function render() {\n          return React.createElement(Statement, {\n            contract: state.contract,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 160\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/remit\",\n        render: function render() {\n          return React.createElement(Remit, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 163\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/entermoney/:purpose\",\n        render: function render() {\n          return React.createElement(EnterMoney, {\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 166\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/viewtransactions\",\n        render: function render() {\n          return React.createElement(ViewTransactions, {\n            info: state,\n            logout: _logout,\n            redirect: _redirectLogin,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 169\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default withRouter(App);","map":{"version":3,"sources":["C:\\Users\\judam\\Documents\\HJ\\dev\\truffle_react\\client\\src\\App.js"],"names":["React","Component","Route","Switch","withRouter","Redirect","getWeb3","truffleContract","Bank","IndexPage","ListPage","InputMoney","Submit","Statement","CheckPassword","Remit","EnterMoney","ViewTransactions","USERS","Kane","Trout","Kershow","Johnson","App","state","web3","accounts","contract","userAddress","componentDidMount","eth","getAccounts","Contract","setProvider","currentProvider","deployed","instance","setState","localStorage","clear","alert","console","log","set","_initUser","get","userInfo","i","length","userBank","userName","password","balanceOf","addUser","from","_login","address","setUser","getUserName","props","history","push","setItem","_logout","initUser","balance","_redirectLogin"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Route, Switch, withRouter, Redirect } from 'react-router-dom'\r\n\r\nimport getWeb3 from './utils/getWeb3'\r\nimport truffleContract from 'truffle-contract'\r\nimport Bank from './contracts/Bank.json'\r\n\r\nimport IndexPage from './component/IndexPage'\r\nimport ListPage from './component/ListPage'\r\nimport InputMoney from './component/InputMoney'\r\nimport Submit from './component/Submit'\r\nimport Statement from './component/Statement'\r\nimport CheckPassword from './component/CheckPassword'\r\nimport Remit from './component/Remit'\r\nimport EnterMoney from './component/EnterMoney'\r\nimport ViewTransactions from './component/ViewTransactions';\r\n\r\nimport \"./css/App.css\"\r\nimport { USERS } from './DB/DB'\r\nimport { Kane, Trout, Kershow, Johnson } from './DB/UserInfo'\r\n\r\nclass App extends Component {\r\n  state = { \r\n    web3: null, \r\n    accounts: null, \r\n    contract: null, \r\n    userAddress: null\r\n  }\r\n\r\n  componentDidMount = async () => {\r\n    try {\r\n      // Get network provider and web3 instance.\r\n      const web3 = await getWeb3()\r\n      \r\n      // Use web3 to get the user's accounts.\r\n      const accounts = await web3.eth.getAccounts()\r\n      \r\n      // Deploy Contract\r\n      const Contract = truffleContract(Bank)\r\n\r\n      Contract.setProvider(web3.currentProvider)\r\n\r\n      const instance = await Contract.deployed()\r\n      \r\n      // Set web3, accounts, contract in state\r\n      this.setState({ web3, accounts, contract : instance })\r\n      \r\n      //Clear localStorage\r\n      localStorage.clear()\r\n    } catch (error) {\r\n      // Catch any errors for any of the above operations.\r\n      alert(\r\n        `Failed to load web3, accounts, or contract. Check console for details.`\r\n        )\r\n        console.log(error)\r\n    }\r\n\r\n    const { accounts } = this.state\r\n\r\n    USERS.set(accounts[1], Kane)\r\n    USERS.set(accounts[2], Trout)\r\n    USERS.set(accounts[3], Kershow)\r\n    USERS.set(accounts[4], Johnson)\r\n\r\n    //Set initial user informations in the contract\r\n    // this._addUser()\r\n  }\r\n    \r\n  //Add user informations in the contract\r\n  _initUser = async () => {  \r\n    const { accounts } = this.state\r\n\r\n    const Kane = USERS.get(accounts[1])\r\n    const Trout = USERS.get(accounts[2])\r\n    const Kershow = USERS.get(accounts[3])\r\n    const Johnson = USERS.get(accounts[4])\r\n\r\n    const userInfo = [ Kane, Trout, Kershow, Johnson ]\r\n\r\n    for(let i=0; i<userInfo.length; i++){\r\n      const {userBank, userName, password, userAddress, balanceOf} = userInfo[i]\r\n      \r\n      console.log(\"App_initUser : \", userAddress)\r\n      \r\n      await this.state.contract.addUser(userBank, userName, password, userAddress, balanceOf, { from: this.state.accounts[0] })\r\n    }\r\n  }\r\n  \r\n  _login = async address => {\r\n    const { contract, accounts } = this.state\r\n\r\n    try{\r\n      //Set user in the contract\r\n      await contract.setUser(address, { from : accounts[0] })\r\n\r\n      const userName = await contract.getUserName()\r\n\r\n      const userAddress = address\r\n\r\n      this.setState({ userAddress })\r\n\r\n      if(userName === '') {\r\n        console.log(\"Input your address correctly\")\r\n\r\n        this.props.history.push('/')\r\n      } else {\r\n        //set balance in localStorage\r\n        localStorage.setItem('isLogin', \"true\")\r\n  \r\n        this.props.history.push('/listpage')\r\n      }\r\n    } catch(error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  _logout = async () => {\r\n    //Initialize user in the contract\r\n    await this.state.contract.initUser({ from : this.state.accounts[0] })\r\n\r\n    //Set the balance for null in state\r\n    this.setState({ balance : 0, userName : ''})\r\n\r\n    //Clear localStorage\r\n    localStorage.clear()\r\n\r\n    this.props.history.push('/')\r\n  }\r\n\r\n  _redirectLogin = () => {\r\n    console.log('고객 정보가 없습니다.')\r\n    return <Redirect to='/' />\r\n  }\r\n\r\n  render() {\r\n    const {_login, _logout, _redirectLogin, _initUser, state} = this\r\n\r\n    if (!this.state.web3) {\r\n      return <div>Loading Web3, accounts, and contract...</div>\r\n    }\r\n    return (\r\n      <div className=\"App\">\r\n        <Switch>\r\n          <Route exact path='/'\r\n            render={() => (<IndexPage info={state} login={_login} init={_initUser} />)}\r\n          />\r\n          <Route path=\"/listpage\" \r\n            render={() => (<ListPage info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/inputmoney' \r\n            render={() => (<InputMoney logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/checkpassword/:purpose'\r\n            render={()=> (<CheckPassword info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/submit/:purpose' \r\n            render={() => (<Submit info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/statement/:purpose' \r\n            render={() => (<Statement contract={state.contract} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/remit' \r\n            render={() => (<Remit info={state} logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/entermoney/:purpose' \r\n            render={() => (<EnterMoney logout={_logout} redirect={_redirectLogin} />)} \r\n          />\r\n          <Route path='/viewtransactions'\r\n            render={() => (<ViewTransactions info={state} logout={_logout} redirect={_redirectLogin} />)}\r\n          />\r\n        </Switch>\r\n      </div>\r\n    )\r\n  }\r\n} \r\n\r\nexport default withRouter(App)\r\n"]},"metadata":{},"sourceType":"module"}